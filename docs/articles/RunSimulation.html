<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>RunSimulation â€¢ stratifiedSSL</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="RunSimulation"><meta property="og:description" content="stratifiedSSL"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">stratifiedSSL</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/RunSimulation.html">RunSimulation</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>





<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>RunSimulation</h1>
            
      
      
      <div class="hidden name"><code>RunSimulation.Rmd</code></div>

    </div>

    
    
<div id="load-the-r-package" class="section level1">
<h1>Load the R package</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stratifiedSSL)</span></code></pre></div>
</div>
<div id="load-the-simulated-data" class="section level1">
<h1>Load the simulated data</h1>
<p>The parameter used in this simulated data are the following: - n_lab
= 400 - n_unlab = 20000 - p = 10 - rho = 0.4 - num_strata = 2</p>
<p>In this setting, we assume correct outcome and correct
imputation.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameters used for generating the simulated data</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>n_lab <span class="ot">&lt;-</span> <span class="dv">400</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>n_unlab <span class="ot">&lt;-</span> <span class="dv">20000</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>rho <span class="ot">&lt;-</span> <span class="fl">0.4</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>num_strata <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the simulated data.</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(simulation_data)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Format the data.</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Format the data.</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>X_labeled <span class="ot">&lt;-</span> simulation_data<span class="sc">$</span>covariates_lab</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>X_unlabeled <span class="ot">&lt;-</span> simulation_data<span class="sc">$</span>covariates_unlab</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>S_unlabeled <span class="ot">&lt;-</span> simulation_data<span class="sc">$</span>S_unlab</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>S_labeled <span class="ot">&lt;-</span> simulation_data<span class="sc">$</span>S_lab</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> simulation_data<span class="sc">$</span>Y_lab</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>samp_prob <span class="ot">&lt;-</span> simulation_data<span class="sc">$</span>samp_prob</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>basis_type <span class="ot">&lt;-</span> <span class="st">&#39;NS_basis&#39;</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>reps <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>num_perts <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>num_knots <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>basis_type <span class="ot">&lt;-</span> <span class="st">&#39;NS_basis&#39;</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>my_threshold <span class="ot">&lt;-</span> <span class="fl">0.5</span></span></code></pre></div>
</div>
<div id="run-the-full-analysis" class="section level1">
<h1>Run the full analysis</h1>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>stratifiedSSL_results <span class="ot">&lt;-</span> <span class="fu">RunStratifiedSSL</span>(X_labeled, X_unlabeled, S_labeled, S_unlabeled, y, samp_prob, </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>                                          num_knots, basis_type, num_folds, my_threshold, reps, num_perts)</span></code></pre></div>
</div>
<div id="detailed-steps-of-the-full-analysis" class="section level1">
<h1>Detailed steps of the full analysis</h1>
<div id="get-basis-expansion" class="section level2">
<h2>Get basis expansion</h2>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>num_knots <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>basis_type <span class="ot">&lt;-</span> <span class="st">&#39;NS_basis&#39;</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(basis_type <span class="sc">==</span> <span class="st">&#39;NS_basis&#39;</span>){</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  my_basis <span class="ot">&lt;-</span> <span class="fu">NaturalSplineBasis</span>(<span class="fu">rbind</span>(X_labeled, X_unlabeled),</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">c</span>(S_labeled, S_unlabeled),</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">num_knots =</span> num_knots)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>}<span class="cf">else</span>{</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  my_basis <span class="ot">&lt;-</span> <span class="fu">AlternativeBasis</span>(<span class="fu">rbind</span>(X_labeled, X_unlabeled),</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">c</span>(S_labeled, S_unlabeled),</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>                               <span class="at">num_knots =</span> num_knots, <span class="at">basis_type =</span> basis_type) </span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>basis_labeled <span class="ot">&lt;-</span> my_basis[<span class="dv">1</span><span class="sc">:</span>n_lab, ]</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>basis_unlabeled <span class="ot">&lt;-</span> my_basis[(n_lab<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="fu">nrow</span>(my_basis), ]</span></code></pre></div>
</div>
<div id="fit-the-regression-model" class="section level2">
<h2>Fit the regression model</h2>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>regression_result <span class="ot">&lt;-</span> <span class="fu">SemiSupervisedRegression</span>(basis_labeled,</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>                                              basis_unlabeled,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>                                              X_labeled,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>                                              X_unlabeled,</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>                                              y,</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>                                              samp_prob,</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">lambda =</span> <span class="cn">NULL</span>)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Supervised beta.</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>beta_sl <span class="ot">&lt;-</span> regression_result<span class="sc">$</span>beta_SL</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Semi-supervised beta.</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>beta_ssl <span class="ot">&lt;-</span> regression_result<span class="sc">$</span>beta_SSL</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Naive beta with no sampling probability.</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>beta_naive <span class="ot">&lt;-</span> regression_result<span class="sc">$</span>beta_SL_unweighted</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Gamma from imputation.</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>gamma <span class="ot">&lt;-</span> regression_result<span class="sc">$</span>gamma</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Beta from density ratio method.</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>beta_dr <span class="ot">&lt;-</span> regression_result<span class="sc">$</span>beta_DR</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="co"># DR projection.</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>proj_dr <span class="ot">&lt;-</span> regression_result<span class="sc">$</span>proj_DR</span></code></pre></div>
</div>
<div id="cross-validated-residuals." class="section level2">
<h2>Cross-validated residuals.</h2>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>num_folds <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>cv_residuals <span class="ot">&lt;-</span> <span class="fu">CrossValResids</span>(basis_labeled, basis_unlabeled, X_labeled,</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>                               X_unlabeled, y, samp_prob, num_folds)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the CV residuals.</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>resids_sl <span class="ot">&lt;-</span> cv_residuals<span class="sc">$</span>resids_beta_sl</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>resids_ssl <span class="ot">&lt;-</span> cv_residuals<span class="sc">$</span>resids_beta_ssl</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>resids_dr <span class="ot">&lt;-</span> cv_residuals<span class="sc">$</span>resids_beta_dr</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>resids_gamma <span class="ot">&lt;-</span> cv_residuals<span class="sc">$</span>resids_gamma</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Save all the residuals.</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>resids_all <span class="ot">&lt;-</span> <span class="fu">cbind</span>(resids_ssl, resids_sl, resids_dr, resids_gamma)</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Standard error estimates for supervised and semi-supervised estimates.</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>beta_sl_se_obj <span class="ot">&lt;-</span> <span class="fu">StdErrorEstimation</span>(X_labeled, X_unlabeled, y,</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>                                     beta_sl, resids_sl)</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>beta_ssl_se_obj <span class="ot">&lt;-</span> <span class="fu">StdErrorEstimation</span>(X_labeled, X_unlabeled, y,</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>                                      beta_ssl, resids_gamma)</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>beta_dr_se_obj <span class="ot">&lt;-</span> <span class="fu">StdErrorEstimationDR</span>(X_labeled, X_unlabeled, y,</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>                                       beta_dr, resids_dr, proj_dr)</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Supervised SE and inverse info.</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>beta_sl_se <span class="ot">&lt;-</span> beta_sl_se_obj<span class="sc">$</span>std_error</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>beta_sl_inv_info <span class="ot">&lt;-</span> beta_sl_se_obj<span class="sc">$</span>inverse_information</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Semi-supervised SE and inverse info.</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>beta_ssl_se <span class="ot">&lt;-</span> beta_ssl_se_obj<span class="sc">$</span>std_error</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>beta_ssl_inv_info <span class="ot">&lt;-</span> beta_ssl_se_obj<span class="sc">$</span>inverse_information</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Semi-supervised SE and inverse info.</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>beta_dr_se <span class="ot">&lt;-</span> beta_dr_se_obj</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Minimum Variance Estimator (here the component-wise optimal estimator).</span></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>beta_minvar <span class="ot">&lt;-</span> <span class="fu">SemiSupervisedMinVarRegression</span>(beta_ssl, beta_sl,</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>                                              beta_ssl_se,</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>                                              beta_sl_se,</span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>                                              resids_gamma,</span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>                                              resids_sl,</span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>                                              X_labeled,</span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>                                              X_unlabeled,</span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">epsilon =</span> <span class="cn">NULL</span>)</span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the results.</span></span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>beta_mv <span class="ot">&lt;-</span> beta_minvar<span class="sc">$</span>beta_SSL_min_var</span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>mv_weight <span class="ot">&lt;-</span> beta_minvar<span class="sc">$</span>min_var_weight</span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>beta_mv_se <span class="ot">&lt;-</span> beta_minvar<span class="sc">$</span>se_beta_weight</span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Save all the standard errors.</span></span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>se_all <span class="ot">&lt;-</span> <span class="fu">cbind</span>(beta_ssl_se,  beta_mv_se, beta_sl_se, beta_dr_se)</span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Save all the beta coefficients.</span></span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a>beta_all <span class="ot">&lt;-</span> <span class="fu">cbind</span>(beta_ssl, beta_mv, beta_sl, beta_dr, beta_naive)</span></code></pre></div>
</div>
<div id="apparent-accuracy-estimates." class="section level2">
<h2>Apparent accuracy estimates.</h2>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>my_threshold <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>acc_sl <span class="ot">&lt;-</span> <span class="fu">SupervisedApparentAccuracy</span>(X_labeled, y, beta_sl, samp_prob,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">resamp_weight =</span> <span class="cn">NULL</span>,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">threshold =</span> my_threshold)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>acc_ssl <span class="ot">&lt;-</span> <span class="fu">SemiSupervisedApparentAccuracy</span>(basis_labeled, basis_unlabeled,</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>                                          X_labeled, X_unlabeled,</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>                                          y, beta_mv, gamma, samp_prob,</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">resamp_weight =</span> <span class="cn">NULL</span>,</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">threshold =</span> my_threshold)</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>acc_dr <span class="ot">&lt;-</span> <span class="fu">SupervisedApparentAccuracy</span>(X_labeled, y, beta_dr, samp_prob,</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">resamp_weight =</span> <span class="cn">NULL</span>,</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">threshold =</span> my_threshold)</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>acc_naive <span class="ot">&lt;-</span> <span class="fu">SupervisedApparentAccuracy</span>(X_labeled, y, beta_sl,</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>                                        <span class="fu">rep</span>(<span class="dv">1</span>, <span class="fu">length</span>(y)),</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">resamp_weight =</span> <span class="cn">NULL</span>,</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">threshold =</span> my_threshold)</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>acc_ap_omr <span class="ot">&lt;-</span> <span class="fu">c</span>(acc_ssl<span class="sc">$</span>omr_ssl, acc_sl<span class="sc">$</span>omr_sl, acc_dr<span class="sc">$</span>omr_sl, acc_naive<span class="sc">$</span>omr_sl)</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>acc_ap_mse <span class="ot">&lt;-</span> <span class="fu">c</span>(acc_ssl<span class="sc">$</span>mse_ssl, acc_sl<span class="sc">$</span>mse_sl, acc_dr<span class="sc">$</span>mse_sl, acc_naive<span class="sc">$</span>mse_sl)</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>acc_ap_omr</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.1364530 0.1258748 0.1199105 0.1225000</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>acc_ap_mse</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.09870030 0.09264466 0.09220015 0.09045252</span></span></code></pre></div>
</div>
<div id="cross-validated-accuracy-estimates." class="section level2">
<h2>Cross-validated accuracy estimates.</h2>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>reps <span class="ot">&lt;-</span> <span class="dv">2</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co"># reps is set to be low to run quickly as an example. We recommend 10-20.</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>acc_cv <span class="ot">&lt;-</span> <span class="fu">CrossValAccuracy</span>(basis_labeled, basis_unlabeled,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>                           X_labeled, X_unlabeled, y, samp_prob,</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>                           mv_weight[,<span class="dv">1</span>],</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>                           num_folds, reps,</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>                           my_threshold, <span class="at">lambda0 =</span> <span class="cn">NULL</span>)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>acc_cv_omr <span class="ot">&lt;-</span> <span class="fu">c</span>(acc_cv<span class="sc">$</span>omr_ssl, acc_cv<span class="sc">$</span>omr_sl, acc_cv<span class="sc">$</span>omr_dr, acc_cv<span class="sc">$</span>omr_naive)</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>acc_cv_mse <span class="ot">&lt;-</span> <span class="fu">c</span>(acc_cv<span class="sc">$</span>mse_ssl, acc_cv<span class="sc">$</span>mse_sl, acc_cv<span class="sc">$</span>mse_dr, acc_cv<span class="sc">$</span>mse_naive)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>acc_cv_omr</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.1664973 0.1549045 0.1523689 0.1512363</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>acc_cv_mse</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.1134044 0.1074890 0.1075047 0.1049373</span></span></code></pre></div>
</div>
<div id="ensemble-of-apparent-and-cv-estimator." class="section level2">
<h2>Ensemble of apparent and CV estimator.</h2>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>cv_weight <span class="ot">&lt;-</span> num_folds <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> num_folds <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>acc_en_omr <span class="ot">&lt;-</span> cv_weight <span class="sc">*</span> acc_ap_omr <span class="sc">+</span> ((<span class="dv">1</span><span class="sc">-</span>cv_weight) <span class="sc">*</span> acc_cv_omr)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>acc_en_mse <span class="ot">&lt;-</span> cv_weight <span class="sc">*</span> acc_ap_mse <span class="sc">+</span> ((<span class="dv">1</span><span class="sc">-</span>cv_weight) <span class="sc">*</span> acc_cv_mse)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>acc_en_omr</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.1484707 0.1374866 0.1328939 0.1339945</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>acc_en_mse</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.10458194 0.09858240 0.09832197 0.09624642</span></span></code></pre></div>
</div>
<div
id="perturbation-for-standard-error-estimates-for-accuracy-estimates."
class="section level2">
<h2>Perturbation for standard error estimates for accuracy
estimates.</h2>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>num_perts <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co"># num_perts is set to be low to run quickly as an example. We recommend 500.</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>acc_pert <span class="ot">&lt;-</span> <span class="fu">AccuracyStdErrorEstimation</span>(basis_labeled, basis_unlabeled,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>                                       X_labeled, X_unlabeled, y,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>                                       samp_prob,</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>                                       mv_weight[,<span class="dv">1</span>],</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>                                       beta_sl,</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>                                       beta_mv,</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>                                       beta_dr,</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>                                       resids_sl,</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>                                       resids_gamma,</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>                                       resids_dr,</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>                                       proj_dr,</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>                                       beta_ssl_inv_info,</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">num_resamples =</span> num_perts,</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">threshold =</span> my_threshold)</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Save results.</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>ssl_pert_mse <span class="ot">&lt;-</span> acc_pert<span class="sc">$</span>ssl_pert_mse</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>sl_pert_mse <span class="ot">&lt;-</span> acc_pert<span class="sc">$</span>sl_pert_mse</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>dr_pert_mse <span class="ot">&lt;-</span> acc_pert<span class="sc">$</span>dr_pert_mse</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>ssl_pert_omr <span class="ot">&lt;-</span> acc_pert<span class="sc">$</span>ssl_pert_omr</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>sl_pert_omr <span class="ot">&lt;-</span> acc_pert<span class="sc">$</span>sl_pert_omr</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>dr_pert_omr <span class="ot">&lt;-</span> acc_pert<span class="sc">$</span>dr_pert_omr</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Save all the results.</span></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>pert_mse_all <span class="ot">&lt;-</span> <span class="fu">cbind</span>(ssl_pert_mse, sl_pert_mse, dr_pert_mse)</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>pert_omr_all <span class="ot">&lt;-</span> <span class="fu">cbind</span>(ssl_pert_omr, sl_pert_omr, dr_pert_omr)</span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
      </div>

</div>



      <footer><div class="copyright">
  <p></p><p>Developed by Jessica Gronsbell, Molei Liu, Lu Tian, Tianxi Cai,
Clara-Lea Bonzel.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a>
2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>
